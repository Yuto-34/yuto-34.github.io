<!DOCTYPE html>
<html lang="ja">
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162881724-3"></script>
<script>
	window.dataLayer = window.dataLayer || [];

	function gtag() {
		dataLayer.push(arguments);
	}
	gtag('js', new Date());

	gtag('config', 'UA-162881724-3');

</script>

<!-- jQueryの指定 -->
<script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<!-- ＃リンクのスムーズスクロール -->
<script>
	$(function() {
		// #で始まるリンクをクリックしたら実行されます
		$('a[href^="#"]').click(function() {
			// スクロールの速度
			var speed = 400; // ミリ秒で記述
			var href = $(this).attr("href");
			var target = $(href == "#" || href == "" ? 'html' : href);
			var position = target.offset().top;
			$('body,html').animate({
				scrollTop: position
			}, speed, 'swing');
			return false;
		});
	});

</script>
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=latex&lang=tex&lang=ruby&lang=c&lang=html&lang=css&lang=js&lang=bash&lang=sh"></script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config"> MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" }},
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
    },
    "HTML-CSS": { matchFontHeight: false },
    displayAlign: "left",
    displayIndent: "2em"
});
</script>

<!-- Place your kit's code here -->
<script src="https://kit.fontawesome.com/da2a99b904.js" crossorigin="anonymous"></script>

<meta charset="utf-8" />
<meta name="msapplication-square70x70logo" content="./favicons/site-tile-70x70.png">
<meta name="msapplication-square150x150logo" content="./favicons/site-tile-150x150.png">
<meta name="msapplication-wide310x150logo" content="./favicons/site-tile-310x150.png">
<meta name="msapplication-square310x310logo" content="./favicons/site-tile-310x310.png">
<meta name="msapplication-TileColor" content="#0078d7">
<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="./favicons/favicon.ico">
<link rel="icon" type="image/vnd.microsoft.icon" href="./favicons/favicon.ico">
<link rel="apple-touch-icon" sizes="57x57" href="./favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="./favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="./favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="./favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="./favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="./favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="./favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="./favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="./favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" sizes="36x36" href="./favicons/android-chrome-36x36.png">
<link rel="icon" type="image/png" sizes="48x48" href="./favicons/android-chrome-48x48.png">
<link rel="icon" type="image/png" sizes="72x72" href="./favicons/android-chrome-72x72.png">
<link rel="icon" type="image/png" sizes="96x96" href="./favicons/android-chrome-96x96.png">
<link rel="icon" type="image/png" sizes="128x128" href="./favicons/android-chrome-128x128.png">
<link rel="icon" type="image/png" sizes="144x144" href="./favicons/android-chrome-144x144.png">
<link rel="icon" type="image/png" sizes="152x152" href="./favicons/android-chrome-152x152.png">
<link rel="icon" type="image/png" sizes="192x192" href="./favicons/android-chrome-192x192.png">
<link rel="icon" type="image/png" sizes="256x256" href="./favicons/android-chrome-256x256.png">
<link rel="icon" type="image/png" sizes="384x384" href="./favicons/android-chrome-384x384.png">
<link rel="icon" type="image/png" sizes="512x512" href="./favicons/android-chrome-512x512.png">
<link rel="icon" type="image/png" sizes="36x36" href="./favicons/icon-36x36.png">
<link rel="icon" type="image/png" sizes="48x48" href="./favicons/icon-48x48.png">
<link rel="icon" type="image/png" sizes="72x72" href="./favicons/icon-72x72.png">
<link rel="icon" type="image/png" sizes="96x96" href="./favicons/icon-96x96.png">
<link rel="icon" type="image/png" sizes="128x128" href="./favicons/icon-128x128.png">
<link rel="icon" type="image/png" sizes="144x144" href="./favicons/icon-144x144.png">
<link rel="icon" type="image/png" sizes="152x152" href="./favicons/icon-152x152.png">
<link rel="icon" type="image/png" sizes="160x160" href="./favicons/icon-160x160.png">
<link rel="icon" type="image/png" sizes="192x192" href="./favicons/icon-192x192.png">
<link rel="icon" type="image/png" sizes="196x196" href="./favicons/icon-196x196.png">
<link rel="icon" type="image/png" sizes="256x256" href="./favicons/icon-256x256.png">
<link rel="icon" type="image/png" sizes="384x384" href="./favicons/icon-384x384.png">
<link rel="icon" type="image/png" sizes="512x512" href="./favicons/icon-512x512.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicons/icon-16x16.png">
<link rel="icon" type="image/png" sizes="24x24" href="./favicons/icon-24x24.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicons/icon-32x32.png">
<link rel="manifest" href="./favicons/manifest.json">
<!-- ###################################################
				ここからはページ毎に変更する
	################################################### -->
<link rel="stylesheet" type="text/css" href="./import_1.css" />
<meta name="description" content="UEC19 Yutoの課題メモ" />
<title>Code Memo</title>
<link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
<style>

	.check {
        position: relative;
        left: -13px;
		list-style-type: none !important;
		/*ポチ消す*/
    }

	.check:before {
        font-weight: 900;
		font-family: "Font Awesome 5 Free";
        content: "\f00c";
        position: relative;
        left: -7px;
		/*左端からのアイコンまで*/
		color: #ffb03f;
		/*アイコン色*/
	}

</style>
</head>

<body>

<div id="outer">

	<h1 class="bar">課題No.4</h1>

	<div id="main">

		<div class="content">

			<h2> 課題 </h2>
			<p>
				次の微分方程式をルンゲ・クッタ法により t = 0 から t = 3 まで数値的に解き、 計算精度を考察せよ。
			</p>
			\[
				\dfrac{\mathrm{d}^2x}{\mathrm{d}t^2} + t\dfrac{\mathrm{d}x}{\mathrm{d}t} + 20 x = 0
			\]
			\[
				t = 0においてx = 1, \dfrac{\mathrm{d}x}{\mathrm{d}t} = 0
			\]
			<p>
				刻み幅を変更しながら得られた計算結果から、 その計算の精度などについて考察を行ない、 t = 3 のときの真の値を推測せよ。 なお、微分方程式を解く区間は、必要があれば各自で変更しても良い。 また、 各自で任意の微分方程式ひとつについて、 同様の考察を行なえ。
			</p>
			<p>ポイントは以下 </p>
			<ul>
				<li>指定の常微分方程式を数値解析により求めるプログラムを完成する．</li>
                <li>刻み幅を変更して解析し，精度などについて考察する．必要に応じてグラフを添付してもよいこととする．</li>
                <li>$t = 3$ のときの真の値を推測する．</li>
				<li>各自で任意の微分方程式ひとつについて，同様の考察をする．</li>
				<li>その他．
            </ul>

			<h2> 対応資料 </h2>
			<p>
				<a class="exit" rel="noopenner" target="blanc" href="https://drive.google.com/drive/folders/1AUsVRRk54RYw0GY2iKGJbU-hZ8txxda6?usp=sharing">Google Drive</a>
			</p>

			<h2> Code </h2>
			<h3> Ass.c </h3>
			<figure>
				<code contenteditable="true">
					<pre class="prettyprint linenums lang-c" contenteditable="true">
#include &lt;math.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;

/* 1910098 Yuto Uematsu */
/* 課題(ルンゲクッタ) */

int verbose = 0, query = 1;

double func(double t, double x, double v) { return -0.1 * x; }

double vtox(double t, double x, double v) { return v; }

int main(int argc, char **argv) {
    double t, tfrom, tto, h;
    double x, a, b, c, d, delta;
    double v, va, vb, vc, vd, vdelta;
    int n, interval = 1;
    char ch;

    while ((ch = getopt(argc, argv, "vp:i:")) != -1) {
        if (ch == 'v') {
            verbose = 1;
        }
        if (ch == 'p') {
            query = 0;
            sscanf(optarg, "%lf,%lf,%lf,%lf,%lf", &tfrom, &x, &v, &tto, &h);
        }
        if (ch == 'i') {
            interval = atol(optarg);
        }
    }

    if (query) {
        printf("t0 x0 v0 tto tinterval> ");
        scanf("%lf %lf %lf %lf %lf", &tfrom, &x, &v, &tto, &h);
    }

    n = 0;
    t = tfrom;
    while (t <= tto) {
        a = h * vtox(t, x, v);
        va = h * func(t, x, v);
        b = h * vtox(t + h / 2.0, x + a / 2.0, v + va / 2.0);
        vb = h * func(t + h / 2.0, x + a / 2.0, v + va / 2.0);
        c = h * vtox(t + h / 2.0, x + b / 2.0, v + vb / 2.0);
        vc = h * func(t + h / 2.0, x + b / 2.0, v + vb / 2.0);
        d = h * vtox(t + h, x + c, v + vc);
        vd = h * func(t + h, x + c, v + vc);
        delta = (a + 2.0 * b + 2.0 * c + d) / 6.0;
        vdelta = (va + 2.0 * vb + 2.0 * vc + vd) / 6.0;

        if (n % interval == 0) {
            printf("%20.14lf %20.14lf %20.14lf %20.14lf %20.14lf\n", t, x, v, delta, vdelta);
        }
        n++;
        t = tfrom + h * n;
        x += delta;
        v += vdelta;
    }

    return 0;
}
</pre>
				</code>
			</figure>


		</div>
			<h2> 実行結果例 </h2>
			<figure>
				<code contenteditable="true">
<pre class="prettyprint lang-bash" lang-sh contenteditable="true">
> ./xmp05c
x0 y0 xto xinterval> 0 0 1 0.25
    0     0.00000000000000     0.00000000000000     0.03401692708333
    1     0.25000000000000     0.03401692708333     0.11468254195319
    2     0.50000000000000     0.14869946903653     0.21825855687968
    3     0.75000000000000     0.36695802591620     0.35125191328512
    4     1.00000000000000     0.71820993920132     0.52201763409933

> ./xmp05c
x0 y0 xto xinterval> 0 0 1 0.125
    0     0.00000000000000     0.00000000000000     0.00814819335938
    1     0.12500000000000     0.00814819335938     0.02587663475424
    2     0.25000000000000     0.03402482811362     0.04596558609191
    3     0.37500000000000     0.07999041420553     0.06872934500667
    4     0.50000000000000     0.14871975921220     0.09452405729501
    5     0.62500000000000     0.24324381650721     0.12375328892276
    6     0.75000000000000     0.36699710542997     0.15687433993503
    7     0.87500000000000     0.52387144536499     0.19440539905174
    8     1.00000000000000     0.71827684441673     0.23693365088471

> ./xmp05c
x0 y0 xto xinterval> 0 0 1 0.0625
    0     0.00000000000000     0.00000000000000     0.00199445088704
    1     0.06250000000000     0.00199445088704     0.00615398508227
    2     0.12500000000000     0.00814843596931     0.01058178615135
    3     0.18750000000000     0.01873022212066     0.01529515581903
    4     0.25000000000000     0.03402537793969     0.02031251167525
    5     0.31250000000000     0.05433788961494     0.02565345914232
    6     0.37500000000000     0.07999134875727     0.03133886808350
    7     0.43750000000000     0.11133021684077     0.03739095435241
    8     0.50000000000000     0.14872117119317     0.04383336660195
    9     0.56250000000000     0.19255453779512     0.05069127869191
   10     0.62500000000000     0.24324581648703     0.05799148805635
   11     0.68750000000000     0.30123730454338     0.06576252041511
   12     0.75000000000000     0.36699982495849     0.07403474123867
   13     0.81250000000000     0.44103456619715     0.08284047440186
   14     0.87500000000000     0.52387504059901     0.09221412849007
   15     0.93750000000000     0.61608916908908     0.10219233125150
   16     1.00000000000000     
</pre>
</code>
			</figure>
			

			<!-- <h2>C</h2>
			<figure>
				<code contenteditable="true">
<pre class="prettyprint linenums lang-c++ " contenteditable="true">

</pre>
</code>
			</figure> -->

		<div id="footer">

			<div class="copy">&#169; 2020 Yutoのホームページ</div>
		</div>
	</div>
</div>
</body>

</html>
