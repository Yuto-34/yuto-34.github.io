<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">

<head>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162881724-2"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag() { dataLayer.push(arguments); }
		gtag('js', new Date());
		gtag('config', 'UA-162881724-2');
	</script>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<meta name="viewport" content="width=device-width" />
	<script
		src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=latex&lang=tex&lang=ruby&lang=c&lang=html&lang=css&lang=js"></script>
	<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
			TeX: { 
				equationNumbers: { autoNumber: "AMS" },
				extensions: ['color.js']
			},
			tex2jax: {
				inlineMath: [ ['$','$'], ["\\(","\\)"] ],
				processEscapes: true
			},
			"HTML-CSS": { matchFontHeight: false },
			displayAlign: "left",
			displayIndent: "2em"
			messageStyle: 'none'
			TeX: {}
			linebreaks: {
				overflow-x: auto;
			}
		});
	</script>

	<!-- ###################################################
				ここからはページ毎に変更する
	################################################### -->
	<link rel="stylesheet" type="text/css" href="./import_1.css" />
	<meta name="keywords" content="Yuto, UEC19, Yuto's Page, フランス語, French, LaTeX, " />
	<meta name="description" content="UEC19のYutoが運営するHPです。ゆる～くやってます" />
	<title>Code Memo</title>
</head>

<body>
	<div id="outer">
		<h1 class="bar">Code Memo</h1>
		<div id="main">
			<div class="content">
				<h2> 課題第3回 </h2>

				<h2> 04g.c </h2>
				<figure>
					<code contenteditable="true">
<pre class="prettyprint linenums lang-c++" contenteditable="true">
#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;unistd.h>
#include &lt;math.h>

/* 中点公式 */

double fun(double x)
{
    return 1.0 / x;
}

int main(int argc, char **argv)
{
    double x, sum;
    double xfrom, xto, hh;
    int xsteps, xidx;

    printf("x: from to steps> ");
    if (argc >= 4)
    {
        xfrom = atof(argv[1]);
        xto = atof(argv[2]);
        xsteps = atol(argv[3]);
        printf("%lf %lf %d\n", xfrom, xto, xsteps);
    }
    else
    {
        scanf("%lf %lf %d", &xfrom, &xto, &xsteps);
    }

    hh = (xto - xfrom) / (2.0 * xsteps);
    sum = 0;
    for (xidx = 0; xidx < xsteps; xidx++)
    {
        x = (xfrom * (xsteps - xidx) + xto * xidx) / xsteps; /* 内分点の計算 */
        sum += fun(x + hh);
    }
    sum *= (xto - xfrom) / xsteps;
    printf("ans:\t%20.15lf\n", sum);
    return 0;
}
</pre>
</code>
				</figure>

				<h2> 04h.c </h2>
				<figure>
					<code contenteditable="true">
<pre class="prettyprint linenums lang-c++" contenteditable="true">
#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;unistd.h>
#include &lt;math.h>

/* 台形公式 */

double fun(double x)
{
    return ((x + 2) * x + 3) * x + 4;
}

int main(int argc, char **argv)
{
    double x, sum;
    double xfrom, xto;
    int xsteps, xidx;

    printf("x: from to steps> ");
    if (argc >= 3)
    {
        xfrom = atof(argv[1]);
        xto = atof(argv[2]);
        xsteps = atol(argv[3]);
        printf("%lf %lf %d\n", xfrom, xto, xsteps);
    }
    else
    {
        scanf("%lf %lf %d", &xfrom, &xto, &xsteps);
    }

    sum = 0;
    for (xidx = 0; xidx < xsteps; xidx++)
    {
        x = (xfrom * (xsteps - xidx) + xto * xidx) / xsteps; /* 内分点の計算 */
        sum += fun(x);
    }
    sum *= 2;
    sum += -fun(xfrom) + fun(xto);
    sum *= (xto - xfrom) / (2.0 * xsteps);
    printf("ans:\t%20.15lf\n", sum);
    return 0;
}
</pre>
</code>
				</figure>

				<h2> 04i.c </h2>
				<figure>
					<code contenteditable="true">
<pre class="prettyprint linenums lang-c++" contenteditable="true">
#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;unistd.h>
#include &lt;math.h>

/* シンプソン公式 */

double fun(double x)
{
    return (((x + 2) * x + 3) * x + 4) * x + 5;
}

int main(int argc, char **argv)
{
    double x, sum;
    double xfrom, xto, hh;
    int xsteps, xidx;

    printf("x: from to steps> ");
    if (argc >= 3)
    {
        xfrom = atof(argv[1]);
        xto = atof(argv[2]);
        xsteps = atol(argv[3]);
        printf("%lf %lf %d\n", xfrom, xto, xsteps);
    }
    else
    {
        scanf("%lf %lf %d", &xfrom, &xto, &xsteps);
    }

    if (xsteps % 2)
    {
        printf("Bad steps\n");
        exit(1);
    }

    sum = 0;
    hh = (xto - xfrom) / xsteps;
    for (xidx = 0; xidx < xsteps; xidx += 2)
    {
        x = (xfrom * (xsteps - xidx) + xto * xidx) / xsteps; /* 内分点の計算 */
        sum += fun(x) + 2 * fun(x + hh);
    }
    sum *= 2;
    sum += -fun(xfrom) + fun(xto);
    sum *= 2.0 * (xto - xfrom) / (6.0 * xsteps);
    printf("ans:\t%20.15lf\n", sum);
    return 0;
}
</pre>
</code>
				</figure>

				<h2> 04j.c </h2>
				<figure>
					<code contenteditable="true">
<pre class="prettyprint linenums lang-c++" contenteditable="true">
#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;unistd.h>
#include &lt;math.h>

/* シンプソン 3/8 公式 */

double fun(double x)
{
    return (((x + 2) * x + 3) * x + 4) * x + 5;
}

int main(int argc, char **argv)
{
    double x, sum;
    double xfrom, xto, hh;
    int xsteps, xidx;

    printf("x: from to steps> ");
    if (argc >= 3)
    {
        xfrom = atof(argv[1]);
        xto = atof(argv[2]);
        xsteps = atol(argv[3]);
        printf("%lf %lf %d\n", xfrom, xto, xsteps);
    }
    else
    {
        scanf("%lf %lf %d", &xfrom, &xto, &xsteps);
    }

    if (xsteps % 3)
    {
        printf("Bad steps\n");
        exit(1);
    }

    sum = 0;
    hh = (xto - xfrom) / xsteps;
    for (xidx = 0; xidx < xsteps; xidx += 3)
    {
        x = (xfrom * (xsteps - xidx) + xto * xidx) / xsteps; /* 内分点の計算 */
        sum += 2 * fun(x) + 3 * (fun(x + hh) + fun(x + 2 * hh));
    }
    sum += -fun(xfrom) + fun(xto);
    sum *= 3.0 * (xto - xfrom) / (8.0 * xsteps);
    printf("ans:\t%20.15lf\n", sum);
    return 0;
}
</pre>
</code>
				</figure>

				<h2> 04a.c </h2>
				<figure>
					<code contenteditable="true">
<pre class="prettyprint linenums lang-c++" contenteditable="true">
#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;unistd.h>
#include &lt;math.h>

/* ガウス 2 点公式 */

double fun(double x)
{
    return sin(x);
}

double scale(double x, double x0, double x1)
{
    return (x0 * (1.0 - x) + x1 * (1.0 + x)) / 2.0;
}

int main(int argc, char **argv)
{
    double x0, x1, y;
    double xfrom, xto;

    printf("x: from to> ");
    if (argc >= 3)
    {
        xfrom = atof(argv[1]);
        xto = atof(argv[2]);
        printf("%lf %lf\n", xfrom, xto);
    }
    else
    {
        scanf("%lf %lf", &xfrom, &xto);
    }

    y = (1.0 * fun(scale(-1.0 / sqrt(3.0), xfrom, xto)) + 1.0 * fun(scale(+1.0 / sqrt(3.0), xfrom, xto))) * (xto - xfrom) / 2.0;

    printf("Answer: %20.14lf\n", y);
    return 0;
}
</pre>
</code>
				</figure>

				<h2> 04b.c </h2>
				<figure>
					<code contenteditable="true">
<pre class="prettyprint linenums lang-c++" contenteditable="true">
#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;unistd.h>
#include &lt;math.h>

/* チェビシェフ 3 点公式 */

double fun(double x)
{
    return sin(x);
}

double scale(double x, double x0, double x1)
{
    return (x0 * (1.0 - x) + x1 * (1.0 + x)) / 2.0;
}

int main(int argc, char **argv)
{
    double x0, x1, y;
    double xfrom, xto;

    printf("x: from to> ");
    if (argc >= 3)
    {
        xfrom = atof(argv[1]);
        xto = atof(argv[2]);
        printf("%lf %lf\n", xfrom, xto);
    }
    else
    {
        scanf("%lf %lf", &xfrom, &xto);
    }

    y = (fun(scale(-1.0 / sqrt(2.0), xfrom, xto)) + fun(scale(0.0, xfrom, xto)) + fun(scale(+1.0 / sqrt(2.0), xfrom, xto))) * (xto - xfrom) / 3.0;

    printf("Answer: %20.14lf\n", y);
    return 0;
}
</pre>
</code>
				</figure>


				<h2> 04c.c</h2>
				<figure>
					<code contenteditable="true">
<pre class="prettyprint linenums lang-c++" contenteditable="true">
#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;unistd.h>
#include &lt;math.h>

/* ガウス 3 点公式 */

double fun(double x)
{
    return sin(x);
}

double scale(double x, double x0, double x1)
{
    return (x0 * (1.0 - x) + x1 * (1.0 + x)) / 2.0;
}

int main(int argc, char **argv)
{
    double x0, x1, y;
    double xfrom, xto;
    int xsteps, xidx;

    printf("x: from to steps> ");
    if (argc >= 4)
    {
        xfrom = atof(argv[1]);
        xto = atof(argv[2]);
        xsteps = atol(argv[3]);
        printf("%lf %lf %d\n", xfrom, xto, xsteps);
    }
    else
    {
        scanf("%lf %lf %d", &xfrom, &xto, &xsteps);
    }

    y = 0;
    x0 = xfrom;

    for (xidx = 1; xidx <= xsteps; xidx++)
    {
        x1 = (xfrom * (xsteps - xidx) + xto * xidx) / xsteps;
        y += ((5.0 / 9.0) * fun(scale(-sqrt(3.0 / 5.0), x0, x1)) + (8.0 / 9.0) * fun(scale(0.0, x0, x1)) + (5.0 / 9.0) * fun(scale(+sqrt(3.0 / 5.0), x0, x1)));
        x0 = x1;
    }
    y *= (xto - xfrom) / (2.0 * xsteps);

    printf("Answer: %20.14lf\n", y);
    return 0;
}
</pre>
</code>
				</figure>
				
				<h2> 04d.c </h2>
				<figure>
					<code contenteditable="true">
<pre class="prettyprint linenums lang-c++" contenteditable="true">
#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;unistd.h>
#include &lt;math.h>

/* チェビシェフ 2 点公式 */

double fun(double x)
{
    return sin(x);
}

double scale(double x, double x0, double x1)
{
    return (x0 * (1.0 - x) + x1 * (1.0 + x)) / 2.0;
}

int main(int argc, char **argv)
{
    double x0, x1, y;
    double xfrom, xto;
    int xsteps, xidx;

    printf("x: from to steps> ");
    if (argc >= 3)
    {
        xfrom = atof(argv[1]);
        xto = atof(argv[2]);
        xsteps = atol(argv[3]);
        printf("%lf %lf %d\n", xfrom, xto, xsteps);
    }
    else
    {
        scanf("%lf %lf %d", &xfrom, &xto, &xsteps);
    }

    y = 0;
    x0 = xfrom;

    for (xidx = 1; xidx <= xsteps; xidx++)
    {
        x1 = (xfrom * (xsteps - xidx) + xto * xidx) / xsteps;
        y += (fun(scale(-sqrt(1.0 / 3.0), x0, x1)) + fun(scale(+sqrt(1.0 / 3.0), x0, x1)));
        x0 = x1;
    }
    y *= (xto - xfrom) / (2.0 * xsteps);

    printf("Answer: %20.14lf\n", y);
    return 0;
}
</pre>
</code>
				</figure>



			<h2 style="padding-bottom: 1ex; padding-top: 1ex;" >授業内課題</h2>
			<p>
				<a target="blanc" rel="noopenner" class="exit" href="./NumericalAnalysis06_attend.pdf">課題</a>
			</p>

			<h2 style="padding-bottom: 1ex; padding-top: 1ex;" >課題</h2>
			<ol>
				<li>最初に、 被積分関数を代数(数式)的に積分して原始関数を (手計算で) 求め、 これを C 言語の関数として定義した上で、 積分範囲の上限と下限を与えることにより 厳密な積分値を計算して出力する。
				<li>次に、 課題に与えられた被積分関数を C の関数として定義し、 これを用いて Simpson の 3/8 公式 (三次のニュートン・コーツ公式) にしたがって 数値積分を行ない 結果を求める。 ここで分割数 (分点の数-1:公式を適用する回数ではないことに注意) は実行時に入力することとし、 入力された分割数の満たすべき条件などをチェックして 満足なものが与えられるまで入力を要求し続けること。 また、 分割数として零または負の値が与えられるまで、 分割数の入力と数値積分結果の出力を何回でも繰り返すこと。
			</ol>
			<p>
				以上について、 得られた積分結果と その計算方法や分割数・精度などについて 考察を行なうこと。 また、 各自で任意の被積分関数ひとつについて、 同様の考察を行なえ。<br>
				さらに、 余裕のある者は、 他の公式を用いた結果とも比較してみよ。 ただし、精度の比較を行なう際には、 関数値を計算する分点数の総数をおおよそ等しくして考察すること。
			</p>
			<p>
				まとめると，ポイントは以下
			</p>
			<ul>
				<li>ひとつのプログラムとして，Simpsonの3/8公式による数値積分を実行するプログラムを完成する．
			</ul>
			<ol>
				<li>被積分関数の原始関数を求めて，C言語の関数として定義，厳密解を求め，出力する機能を実装する．
				<li>入力された分割数が適当な値でない場合は，再度，入力を要求する機能を有する．
				<li>分割数として零または負の値が与えられるまで、 分割数の入力と数値積分結果の出力を何回でも繰り返す．
				<li>計算方法の原理に関する説明．
				<li>各自で被積分関数を用意して，結果を示す．
				<li>分割数が精度に及ぼす影響を考察する．必要に応じてグラフを添付してもよいこととする．
				<li>その他．
			</ol>
			<p>
				余裕があれば，
			</p>
			<ul>
				<li>他の公式との比較．(その際には分点数の総数を等しくして考察)
			</ul>
				


			<!-- <h2>C</h2>
			<figure>
				<code contenteditable="true">
<pre class="prettyprint linenums lang-c++ " contenteditable="true">

</pre>
</code>
			</figure> -->

			</div>
			<div id="footer">
				<div class="copy">&#169; 2020 Yutoのホームページ</div>
			</div>
		</div>
	</div>
</body>

</html>