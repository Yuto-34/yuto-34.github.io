<!DOCTYPE html>
<html lang="ja">
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162881724-3"></script>
<script>
	window.dataLayer = window.dataLayer || [];

	function gtag() {
		dataLayer.push(arguments);
	}
	gtag('js', new Date());

	gtag('config', 'UA-162881724-3');

</script>

<!-- jQueryの指定 -->
<script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<!-- ＃リンクのスムーズスクロール -->
<script>
	$(function() {
		// #で始まるリンクをクリックしたら実行されます
		$('a[href^="#"]').click(function() {
			// スクロールの速度
			var speed = 400; // ミリ秒で記述
			var href = $(this).attr("href");
			var target = $(href == "#" || href == "" ? 'html' : href);
			var position = target.offset().top;
			$('body,html').animate({
				scrollTop: position
			}, speed, 'swing');
			return false;
		});
	});

</script>
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=latex&lang=tex&lang=ruby&lang=c&lang=html&lang=css&lang=js&lang=bash&lang=sh"></script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config"> MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" }},
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
    },
    "HTML-CSS": { matchFontHeight: false },
    displayAlign: "left",
    displayIndent: "2em"
});
</script>

<!-- Place your kit's code here -->
<script src="https://kit.fontawesome.com/da2a99b904.js" crossorigin="anonymous"></script>

<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../favicons/favicon.ico">
<link rel="icon" type="image/vnd.microsoft.icon" href="../favicons/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="../favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" sizes="196x196" href="../favicons/icon-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="../favicons/icon-512x512.png">
<link rel="manifest" href="../favicons/manifest.json">
<!-- ###################################################
				ここからはページ毎に変更する
	################################################### -->
<link rel="stylesheet" type="text/css" href="../import_1.css" />
<meta name="description" content="数値解析の課題メモ" />
<title>NA Assignment 5</title>
<link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
<!-- <meta http-equiv="refresh" content="5;URL=./index.html"> -->
<style>
	.check {
		position: relative;
		left: -13px;
		list-style-type: none !important;
		/*ポチ消す*/
	}

	.check:before {
		font-weight: 900;
		font-family: "Font Awesome 5 Free";
		content: "\f00c";
		position: relative;
		left: -7px;
		/*左端からのアイコンまで*/
		color: #ffb03f;
		/*アイコン色*/
	}

</style>
</head>

<body>

<div id="outer">

	<h1 class="bar">課題No.6 (Last)</h1>

	<div id="main">

		<div class="content">

				<h2> 提出課題 6 </h2>

				<p>
					上記で与えられた ヤコビ法を用いて N 元一次連立方程式
				</p>
				<p>
					[ A ] { x } = { b }
				</p>
				<p>
					の解 x を求めるプログラムに対して，
					以下の問に答えよ．
				</p>


				<ol>
					<li> プログラム例にて，vecXとvecTの役割の違いを説明せよ．
					<li> プログラム例おける収束判定(誤差評価)法を説明せよ．
					<li> matA[i][j]の各行 i において，非零要素が存在する左端位置 j_min と右端位置 j_maxを
						出力できるようにプログラムを修正せよ
						(各行において計算に必要とされる範囲を求める)．
					<li> 上の結果を用いて，
						<!--収束演算を開始する前に係数マトリクス中の非零要素を探し，-->
						反復計算の必要な範囲を局限するようにプログラムを修正せよ．
					<li> 44x44.dat を入力データとして用いた結果を示すこと．
					<li> 各自が用意したdataを用いた結果を示すこと．<br><br>
						<strong>余裕があれば</strong>
					<li> 収束する場合と収束しない場合の方程式/行列の特徴を考察せよ．
					<li> 時間に余裕のある者は，
						反復計算を行なう上で必要となる積和演算の回数を数え上げることができるようにせよ．
						反復計算の必要な範囲を局限した場合としない場合とで定量的な比較を行なえ．
					<li> さらに時間に余裕のある者は，
						Gauss-Jordan 法で解を求めるのに必要となる乗除算と加減算の回数を計算し，
						Jacobi 法で必要となる計算回数と定量的な比較を行なえ．
					<li> さらに時間に余裕のある者は，
						マトリクス中の零要素のメモリを節約することによって，
						より大きなマトリクスを扱えるような修正を行ってみよ．
				</ol>


				<p>
					課題提出用データファイルとしては，
					/class/mce/NumAnalysis/44x44.dat と各自が用意したものとの二つ以上を用い，
					これを標準入力から リダイレクトによって 読み込んで
					計算した結果をレポートに示すこと．
					<br>
					なお， 連立方程式によっては， 収束しない場合もあるので注意すること．
					収束する場合と収束しない場合との特徴を考察できれば， さらに良い．
				</p>


				<hr>
				<p>
					<a href="./xmp09b.output.txt"> 実行結果例 (この例と同じ出力になる必要はない) </a>
					<!-- , 実行ファイル例: /class/mce/NumAnalysis/xmp09b<br> -->
					<!-- 入力データ例: /class/mce/NumAnalysis/{44x44,816x816}.dat,
/class/mce/NumAnalysis/Jacobi0?.dat,
/class/mce/NumAnalysis/heat0?.dat -->
				</p>

				<p>
					入力データ内容<br>
					<a href="./input_data/44x44.dat"> 44x44.dat</a>,
					<a href="./input_data/816x816.dat"> 816x816.dat</a>,
					<a href="./input_data/heat01.dat"> heat01.dat</a>,
					<a href="./input_data/heat02.dat"> heat02.dat</a>,
					<a href="./input_data/heat03.dat"> heat03.dat</a>,
					<a href="./input_data/heat04.dat"> heat04.dat</a>,
					<a href="./input_data/heat05.dat"> heat05.dat</a>,
					<a href="./input_data/heat06.dat"> heat06.dat</a>,
					<a href="./input_data/heat07.dat"> heat07.dat</a>,
					<a href="./input_data/heat08.dat"> heat08.dat</a>,
					<a href="./input_data/heat09.dat"> heat09.dat</a>
				</p>

				<!--
<p>
<b>提出期限: 2015 年 8 月 5 日 18 時</b>
</p>
-->

				<hr>

				<p>
					なお，これらの入力データは以下に示すような温度分布の有限要素解析中に現れるものである．
				</p>

				<table border=2>
					<tr>
						<td align=middle> <img src="./img/44x44.jpg">
						<td align=middle> <img src="./img/816x816.jpg">
					<tr>
						<td align=middle> [ 44x44.dat ]
						<td align=middle> [ 816x816.dat ]
				</table>

				<hr>

				<h2 id="program"> Code </h2>
				<h3> Ass.c(改変前) </h3>
				<figure>
					<code contenteditable="true">
						<pre class="prettyprint linenums lang-c" contenteditable="true">
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;math.h&gt;
#include &lt;time.h&gt;
#include &lt;sys/times.h> // 構造体tmsを使うために必要&gt;
#include &lt;limits.h&gt;

#ifndef SIZE
#define SIZE	(1024)
#endif
#ifndef LIMIT
#define LIMIT	(200)
#endif


double	matA[SIZE][SIZE], vecB[SIZE], vecX[SIZE], vecT[SIZE];
int	n, verbose;

void Simal_Read ( double a[SIZE][SIZE], double b[SIZE] )	/* 連立方程式の読み込み */
{
	int	i, j;

	for ( i=0; i<n; i++ ) {
		for ( j=0; j<n; j++ ) {
			scanf( "%lf", &(a[i][j]) );
		}
		scanf( "%lf", &(b[i]) );
	}
}

void Simal_Write ( double a[SIZE][SIZE], double b[SIZE] )	/* 連立方程式の書き出し */
{
	int	i, j;

	for ( i=0; i<n; i++ ) {
		for ( j=0; j<n; j++ ) {
			printf( "%11.3le ", a[i][j] );
		}
		printf( "	%11.3le\n", b[i] );
	}
}

void V_Write ( double a[SIZE] )					 	/* ベクトルの書き出し */
{
	int i;
	for (i=0; i<n; i++) {
		printf( " %15.8le", a[i] );
	}
	printf( "\n" );
}

int main( int argc, char **argv )
{
	int		i, j, k, cont, cc, dig, map;
	double 	C, Sum, prec, p;
	struct tms	tfrom, tto;
	char		ch, *ptr;

	n = 0;
	verbose = 0;
	map = 0;
	C = 0;
	prec = 1e-5;

	while (( ch = getopt(argc,argv,"vms:i:p:")) != -1 ) {
		if ( ch == 'v' ) { verbose = 1; }		/* おしゃべり */
		if ( ch == 'm' ) { map = 1; }		/* マップ表示選択 */
		if ( ch == 's' ) { n = atoi( optarg ); }	/* 連立元数 Size */
		if ( ch == 'i' ) { C = atof( optarg ); }	/* 初期値 */
		if ( ch == 'p' ) {				/* 要求精度 (桁数) */
			j = atoi( optarg );
			prec = 1.0;
			for (i=0; i<j; i++) {
	prec *= 10.0;
			}
			prec = 1.0 / prec;
		}
	}

	if ( n == 0 ) {
		printf( "Size: " );
		scanf( "%d", &n );
		printf( "\n" );
	}
	if ( n > SIZE ) {			/* エラー処理 */
		printf( "error: Size should be less than or equal to %d.\n", SIZE );
		return 1;
	}

	for (i=0; i<n; i++) {
		vecX[i] = C;			/* 初期値代入 */
	}

	Simal_Read( matA, vecB );		/* 問題の読み込み */
	if (verbose) {
		Simal_Write( matA, vecB );		/* 清書 */
	}

	for (j=0; j<n; j++) {			/* 係数マトリクスの下準備 */
		C = matA[j][j];
		for (k=0; k<n; k++) {
			if (j != k) {
	matA[j][k] = -matA[j][k]/C;	/* 負号の存在に注意 */
			}
		}
		vecB[j] = vecB[j]/C;
	}

	times( &tfrom );			/* 計算時間計測開始 */

	cc = 0;
	cont = 1;
	while ( cont && (cc<LIMIT) ) {
		if (!map) {
			printf( "%03d: ", cc );
			V_Write( vecX );			/* 暫定解の書き出し */
		}

		for (j=0; j<n; j++) {
			Sum = vecB[j];
			for (k=0; k<n; k++) {
	if (j != k) {
		Sum += matA[j][k] * vecX[k];	/* 積和計算 */
	}
			}
			vecT[j] = Sum;
		}
		cc++;

		if (map) {
			printf( "%03d: ", cc );
		}
		cont = 0;
		for (i=0; i<n; i++) {		/* 収束状況の確認 */
			p = 999;
			if ( vecT[i]!=0 && (p=fabs((vecT[i]-vecX[i])/vecT[i])) > prec ) {
	cont = 1; 
			}
			if (map) {			/* 有効桁数マップの作成 */
	dig = (long)( -log(p)/log(10.0)+0.5 );
	if (dig > 35) { dig = 35; }
	if (dig < 0) { dig = 0; }
	printf( "%c", (dig<=0) ? '.' : ((dig<10)?'0'+dig:'A'+dig-10) );
	if (i%100 == 99) {
		printf("\n		 ");
	}
			}
			vecX[i] = vecT[i];
		}
		if (map) {
			printf("\n");
		}
	}

	times( &tto );			/* 計算時間計測終了 */
	printf( "%03d: ", cc );
	V_Write( vecX );			/* 最終解の書き出し */
	printf( "		user cpu time: %.2lf [sec]\n\n",
		(double)(tto.tms_utime-tfrom.tms_utime)/sysconf(_SC_CLK_TCK) );

	return 0;
}
</pre>
					</code>
				</figure>
				<h3> Ass.c(改変後) </h3>
				<figure>
					<code contenteditable="true">
						<pre class="prettyprint linenums lang-c" contenteditable="true">
#include &lt;math.h&gt;
#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;

// 1910098 Yuto Uematsu
// Fauss-Jordan

</pre>
					</code>
				</figure>


		<h2> 実行結果</h2>
		<figure>
			<code contenteditable="true">
				<pre class="prettyprint lang-bash lang-bash lang=bash" contenteditable="true">

</pre>
			</code>
		</figure>


		<!-- <h2>C</h2>
			<figure>
				<code contenteditable="true">
<pre class="prettyprint linenums lang-c++ " contenteditable="true">

</pre>
</code>
			</figure> -->

		<div id="footer">

			<div class="copy">&#169; 2020 Yutoのホームページ</div>
		</div>
	</div>
</div>
</body>

</html>
