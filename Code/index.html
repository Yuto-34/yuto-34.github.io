<!DOCTYPE html>
<html lang="ja">
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162881724-3"></script>
<script>
	window.dataLayer = window.dataLayer || [];

	function gtag() {
		dataLayer.push(arguments);
	}
	gtag('js', new Date());

	gtag('config', 'UA-162881724-3');

</script>

<!-- jQueryの指定 -->
<script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<!-- ＃リンクのスムーズスクロール -->
<script>
	$(function() {
		// #で始まるリンクをクリックしたら実行されます
		$('a[href^="#"]').click(function() {
			// スクロールの速度
			var speed = 400; // ミリ秒で記述
			var href = $(this).attr("href");
			var target = $(href == "#" || href == "" ? 'html' : href);
			var position = target.offset().top;
			$('body,html').animate({
				scrollTop: position
			}, speed, 'swing');
			return false;
		});
	});

</script>
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=latex&lang=tex&lang=ruby&lang=c&lang=html&lang=css&lang=js"></script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config"> MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" }},
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
    },
    "HTML-CSS": { matchFontHeight: false },
    displayAlign: "left",
    displayIndent: "2em"
});
</script>
<meta charset="utf-8" />
<meta name="msapplication-square70x70logo" content="./favicons/site-tile-70x70.png">
<meta name="msapplication-square150x150logo" content="./favicons/site-tile-150x150.png">
<meta name="msapplication-wide310x150logo" content="./favicons/site-tile-310x150.png">
<meta name="msapplication-square310x310logo" content="./favicons/site-tile-310x310.png">
<meta name="msapplication-TileColor" content="#0078d7">
<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="./favicons/favicon.ico">
<link rel="icon" type="image/vnd.microsoft.icon" href="./favicons/favicon.ico">
<link rel="apple-touch-icon" sizes="57x57" href="./favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="./favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="./favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="./favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="./favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="./favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="./favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="./favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="./favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" sizes="36x36" href="./favicons/android-chrome-36x36.png">
<link rel="icon" type="image/png" sizes="48x48" href="./favicons/android-chrome-48x48.png">
<link rel="icon" type="image/png" sizes="72x72" href="./favicons/android-chrome-72x72.png">
<link rel="icon" type="image/png" sizes="96x96" href="./favicons/android-chrome-96x96.png">
<link rel="icon" type="image/png" sizes="128x128" href="./favicons/android-chrome-128x128.png">
<link rel="icon" type="image/png" sizes="144x144" href="./favicons/android-chrome-144x144.png">
<link rel="icon" type="image/png" sizes="152x152" href="./favicons/android-chrome-152x152.png">
<link rel="icon" type="image/png" sizes="192x192" href="./favicons/android-chrome-192x192.png">
<link rel="icon" type="image/png" sizes="256x256" href="./favicons/android-chrome-256x256.png">
<link rel="icon" type="image/png" sizes="384x384" href="./favicons/android-chrome-384x384.png">
<link rel="icon" type="image/png" sizes="512x512" href="./favicons/android-chrome-512x512.png">
<link rel="icon" type="image/png" sizes="36x36" href="./favicons/icon-36x36.png">
<link rel="icon" type="image/png" sizes="48x48" href="./favicons/icon-48x48.png">
<link rel="icon" type="image/png" sizes="72x72" href="./favicons/icon-72x72.png">
<link rel="icon" type="image/png" sizes="96x96" href="./favicons/icon-96x96.png">
<link rel="icon" type="image/png" sizes="128x128" href="./favicons/icon-128x128.png">
<link rel="icon" type="image/png" sizes="144x144" href="./favicons/icon-144x144.png">
<link rel="icon" type="image/png" sizes="152x152" href="./favicons/icon-152x152.png">
<link rel="icon" type="image/png" sizes="160x160" href="./favicons/icon-160x160.png">
<link rel="icon" type="image/png" sizes="192x192" href="./favicons/icon-192x192.png">
<link rel="icon" type="image/png" sizes="196x196" href="./favicons/icon-196x196.png">
<link rel="icon" type="image/png" sizes="256x256" href="./favicons/icon-256x256.png">
<link rel="icon" type="image/png" sizes="384x384" href="./favicons/icon-384x384.png">
<link rel="icon" type="image/png" sizes="512x512" href="./favicons/icon-512x512.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicons/icon-16x16.png">
<link rel="icon" type="image/png" sizes="24x24" href="./favicons/icon-24x24.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicons/icon-32x32.png">
<link rel="manifest" href="./favicons/manifest.json">
<!-- ###################################################
				ここからはページ毎に変更する
	################################################### -->
<link rel="stylesheet" type="text/css" href="./import_1.css" />
<meta name="description" content="NA Yutoのメモ" />
<title>NA Code Memo</title>
</head>

<body>

<div id="outer">

	<h1 class="bar">NA Code Memo</h1>

	<div id="main">

		<div class="content">

            <h2> <a href="./assignment5/">課題No.5</a> </h2>
            <h2> 参考資料+<b>$\alpha$</b> </h2>


			<h2> Gauss-Jordan 法 </h2>

			<p>
			行列 A とベクトル b が与えられたとき， Gauss-Jordan 法を用いて N 元一次連立方程式
			</p>
			<p>
				[ A ] { x } = { b }
			</p>
			<p>
			の解 x と，
			A の逆行列とを同時に求めるプログラムである．
			この時 N は 16 以下としている．
			</p>

			<p>
			入力データ形式は下図左半分に示す内容を持ったものとする．
			すなわち， 先頭の行には連立する方程式の元数を示す整数がひとつあり，
			以降の行には行列 A の各列の要素とベクトル b の各要素とが 含まれているものとする．<br>
			(下図右半分は左半分のデータの読み込まれるべき変数もしくは配列要素である．)
			</p>


			<pre>
	3                                      N
	1.1111  1.1111  1.1111  5.5555         A[0][0]  A[0][1]  A[0][2]  b[0]
	1.1111  2.2222  2.2222  6.6666         A[1][0]  A[1][1]  A[1][2]  b[1]
	1.1111  2.2222  3.3333  7.7777         A[2][0]  A[2][1]  A[2][2]  b[2]
			</pre>

			<div class="note">
				<p>
				Gauss-Jordan 法では，
				行列の対角要素のみを 1 にし，
				残りの要素を全て 0 にすることによって，
				解を求める．
				
				<p>
				連立方程式を解くのと同時に，係数行列の逆行列を求めることができるのが特徴である．<br>
				また，計算量は必ずしも最少ではないが，
				計算のアルゴリズムが非常にシンプルな計算方法である．
				
				<p>
				このソースコードでは マクロ <tt>SIZE</tt> の定義を <tt>#ifndef</tt> と <tt>#endif</tt> とで挟んでいる．<br>
				このため <code> cc -DSIZE=100 -o xmp07a xmp07a.c </code> などのように，
				コマンドラインから定義値を変更してやると，
				ソースコードを変更することなくより大きな配列を扱えるバイナリを作成することができる． 
				
				</p>
				</div>

			<h2> xmp07a.c </h2>
			<figure>
				<code contenteditable="true">
					<pre class="prettyprint linenums lang-c++" contenteditable="true">
#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;unistd.h>
#include &lt;math.h>

#ifndef SIZE
#define SIZE (16)
#endif

double matA[SIZE][SIZE], matE[SIZE][SIZE], vecX[SIZE];

void dump(int n) {
    int j, k;
    for (k = 0; k < n; k++) {
        printf("\n");
        for (j = 0; j < n; j++) printf(" %10.3f", matA[k][j]);
        printf("    %10.3f   ", vecX[k]);
    }
    printf("\n");
}

int main(int argc, char **argv) {
    double C;
    int n, i, j, k;
    char copyright[] = "Written by M.Takata: 1999/01/20\n";
    int ch, verbose;

    verbose = 0;
    while ((ch = getopt(argc, argv, "vh")) != -1) {
        if (ch == 'v') verbose = 1;
        if (ch == 'h') {
            printf("Options:\n");
            printf("\t-v: dumps intermediate results.\n");
            printf("\t-h: shows help message, as you see now.\n");
            printf("\n");
            return 1;
        }
    }

    /* データ入力 */
    scanf("%d", &n);
    if (n > SIZE) {
        printf("N should be less than or equal to %d.\n", SIZE);
        return 1;
    }

    for (i = 0; i < n; i++) {
        for (j = 0; j < n; j++) {
            scanf("%lf", &(matA[i][j]));
        }
        scanf("%lf", &(vecX[i]));
    }

    printf("Inputs:\n");

    for (i = 0; i < n; i++) {
        for (j = 0; j < n; j++) {
            printf(" %12.5le", matA[i][j]);
        }
        printf("  |  %12.5le\n", vecX[i]);
    }

    /* 単位行列の設定 */
    // inv 逆行列計算用 追加 ... 以下 4行の // を削除する．
    //  for ( i=0; i < n; i++ ){
    //    for ( j=0; j < n; j++ ){ matE[i][j] = 0.0; }
    //    matE[i][i] = 1.0;
    //  }

    /* Solve */
    if (verbose) dump(n);

    for (i = 0; i < n; i++) {
        C = matA[i][i];

        for (j = 0; j < n; j++) {
            matA[i][j] /= C;
            // inv 逆行列計算用 追加
        }
        vecX[i] /= C;

        if (verbose) dump(n);

        for (k = 0; k < n; k++) {
            if (i != k) {
                C = matA[k][i];

                for (j = 0; j < n; j++) {
                    matA[k][j] -= matA[i][j] * C;
                    // inv 逆行列計算用 追加
                }
                vecX[k] -= vecX[i] * C;
            }
        }

        if (verbose) dump(n);
    }

    /* 計算結果出力 */
    printf("\nResults:\n");
    for (i = 0; i < n; i++) {
        printf(" %12.3f", vecX[i]);
    }
    printf("\nInverse:  (not yet inplemented)\n");
    for (i = 0; i < n; i++) {
        for (j = 0; j < n; j++) {
            // inv 逆行列計算用出力文追加
        }
        printf("\n");
    }
    printf("\n");
    return 0;
}
</pre>
				</code>
			</figure>

			<h2>実行結果例</h2>
			<figure>
				<code contenteditable="true">
<pre class="prettyprint linenums lang-bash " contenteditable="true">
> ./xmp07a
2
1 2   5
3 4   8
Inputs:
    A:    1          2              B:
 1:     1.0000     2.0000         5.0000
 2:     3.0000     4.0000         8.0000

Results:
         X                  Inverse A
X1=   -2.0000         -2.0000     1.0000
X2=    3.5000          1.5000    -0.5000

--------------------------------------------------
> ./xmp07a -v
2
1 2   5
3 4   8
Inputs:
    A:    1          2              B:
 1:     1.0000     2.0000         5.0000
 2:     3.0000     4.0000         8.0000

   1.000   2.000      5.000      1.000   0.000
   3.000   4.000      8.000      0.000   1.000

   1.000   2.000      5.000      1.000   0.000
   3.000   4.000      8.000      0.000   1.000

   1.000   2.000      5.000      1.000   0.000
   0.000  -2.000     -7.000     -3.000   1.000

   1.000   2.000      5.000      1.000   0.000
  -0.000   1.000      3.500      1.500  -0.500

   1.000   0.000     -2.000     -2.000   1.000
  -0.000   1.000      3.500      1.500  -0.500

Results:
         X                  Inverse A
X1=   -2.0000         -2.0000     1.0000
X2=    3.5000          1.5000    -0.5000

--------------------------------------------------
> ./xmp07a -v < Simal02.dat
Inputs:
    A:    1          2          3          4              B:
 1:     1.0000     3.0000     3.0000     2.0000         4.0000
 2:     2.0000     1.0000    -8.0000    -1.0000         8.0000
 3:     1.0000     1.0000     6.0000     4.0000         7.0000
 4:     1.0000     6.0000     5.0000     2.0000         1.0000

   1.000   3.000   3.000   2.000      4.000      1.000   0.000   0.000   0.000
   2.000   1.000  -8.000  -1.000      8.000      0.000   1.000   0.000   0.000
   1.000   1.000   6.000   4.000      7.000      0.000   0.000   1.000   0.000
   1.000   6.000   5.000   2.000      1.000      0.000   0.000   0.000   1.000

   1.000   3.000   3.000   2.000      4.000      1.000   0.000   0.000   0.000
   2.000   1.000  -8.000  -1.000      8.000      0.000   1.000   0.000   0.000
   1.000   1.000   6.000   4.000      7.000      0.000   0.000   1.000   0.000
   1.000   6.000   5.000   2.000      1.000      0.000   0.000   0.000   1.000

   1.000   3.000   3.000   2.000      4.000      1.000   0.000   0.000   0.000
   0.000  -5.000 -14.000  -5.000      0.000     -2.000   1.000   0.000   0.000
   0.000  -2.000   3.000   2.000      3.000     -1.000   0.000   1.000   0.000
   0.000   3.000   2.000   0.000     -3.000     -1.000   0.000   0.000   1.000

   1.000   3.000   3.000   2.000      4.000      1.000   0.000   0.000   0.000
  -0.000   1.000   2.800   1.000     -0.000      0.400  -0.200  -0.000  -0.000
   0.000  -2.000   3.000   2.000      3.000     -1.000   0.000   1.000   0.000
   0.000   3.000   2.000   0.000     -3.000     -1.000   0.000   0.000   1.000

   1.000   0.000  -5.400  -1.000      4.000     -0.200   0.600   0.000   0.000
  -0.000   1.000   2.800   1.000     -0.000      0.400  -0.200  -0.000  -0.000
   0.000   0.000   8.600   4.000      3.000     -0.200  -0.400   1.000   0.000
   0.000   0.000  -6.400  -3.000     -3.000     -2.200   0.600   0.000   1.000

   1.000   0.000  -5.400  -1.000      4.000     -0.200   0.600   0.000   0.000
  -0.000   1.000   2.800   1.000     -0.000      0.400  -0.200  -0.000  -0.000
   0.000   0.000   1.000   0.465      0.349     -0.023  -0.047   0.116   0.000
   0.000   0.000  -6.400  -3.000     -3.000     -2.200   0.600   0.000   1.000

   1.000   0.000   0.000   1.512      5.884     -0.326   0.349   0.628   0.000
  -0.000   1.000   0.000  -0.302     -0.977      0.465  -0.070  -0.326  -0.000
   0.000   0.000   1.000   0.465      0.349     -0.023  -0.047   0.116   0.000
   0.000   0.000   0.000  -0.023     -0.767     -2.349   0.302   0.744   1.000

   1.000   0.000   0.000   1.512      5.884     -0.326   0.349   0.628   0.000
  -0.000   1.000   0.000  -0.302     -0.977      0.465  -0.070  -0.326  -0.000
   0.000   0.000   1.000   0.465      0.349     -0.023  -0.047   0.116   0.000
  -0.000  -0.000  -0.000   1.000     33.000    101.000 -13.000 -32.000 -43.000

   1.000   0.000   0.000   0.000    -44.000   -153.000  20.000  49.000  65.000
  -0.000   1.000   0.000   0.000      9.000     31.000  -4.000 -10.000 -13.000
   0.000   0.000   1.000   0.000    -15.000    -47.000   6.000  15.000  20.000
  -0.000  -0.000  -0.000   1.000     33.000    101.000 -13.000 -32.000 -43.000

Results:
         X                  Inverse A
X1=  -44.0000       -153.0000    20.0000    49.0000    65.0000
X2=    9.0000         31.0000    -4.0000   -10.0000   -13.0000
X3=  -15.0000        -47.0000     6.0000    15.0000    20.0000
X4=   33.0000        101.0000   -13.0000   -32.0000   -43.0000

------------------------------------------------------------
> ./xmp07a -v < Simal03.dat
Inputs:
    A:    1          2          3          4              B:
 1:     2.0000     5.0000     2.0000     3.0000         6.0000
 2:     4.0000    -2.0000     4.0000     3.0000         3.0000
 3:     1.0000    -5.0000     3.0000     2.0000         8.0000
 4:    -1.0000     2.0000     1.0000     2.0000         1.0000

   2.000   5.000   2.000   3.000      6.000      1.000   0.000   0.000   0.000
   4.000  -2.000   4.000   3.000      3.000      0.000   1.000   0.000   0.000
   1.000  -5.000   3.000   2.000      8.000      0.000   0.000   1.000   0.000
  -1.000   2.000   1.000   2.000      1.000      0.000   0.000   0.000   1.000

   1.000   2.500   1.000   1.500      3.000      0.500   0.000   0.000   0.000
   4.000  -2.000   4.000   3.000      3.000      0.000   1.000   0.000   0.000
   1.000  -5.000   3.000   2.000      8.000      0.000   0.000   1.000   0.000
  -1.000   2.000   1.000   2.000      1.000      0.000   0.000   0.000   1.000

   1.000   2.500   1.000   1.500      3.000      0.500   0.000   0.000   0.000
   0.000 -12.000   0.000  -3.000     -9.000     -2.000   1.000   0.000   0.000
   0.000  -7.500   2.000   0.500      5.000     -0.500   0.000   1.000   0.000
   0.000   4.500   2.000   3.500      4.000      0.500   0.000   0.000   1.000

   1.000   2.500   1.000   1.500      3.000      0.500   0.000   0.000   0.000
  -0.000   1.000  -0.000   0.250      0.750      0.167  -0.083  -0.000  -0.000
   0.000  -7.500   2.000   0.500      5.000     -0.500   0.000   1.000   0.000
   0.000   4.500   2.000   3.500      4.000      0.500   0.000   0.000   1.000

   1.000   0.000   1.000   0.875      1.125      0.083   0.208   0.000   0.000
  -0.000   1.000  -0.000   0.250      0.750      0.167  -0.083  -0.000  -0.000
   0.000   0.000   2.000   2.375     10.625      0.750  -0.625   1.000   0.000
   0.000   0.000   2.000   2.375      0.625     -0.250   0.375   0.000   1.000

   1.000   0.000   1.000   0.875      1.125      0.083   0.208   0.000   0.000
  -0.000   1.000  -0.000   0.250      0.750      0.167  -0.083  -0.000  -0.000
   0.000   0.000   1.000   1.188      5.312      0.375  -0.312   0.500   0.000
   0.000   0.000   2.000   2.375      0.625     -0.250   0.375   0.000   1.000

   1.000   0.000   0.000  -0.312     -4.188     -0.292   0.521  -0.500   0.000
   0.000   1.000   0.000   0.250      0.750      0.167  -0.083   0.000   0.000
   0.000   0.000   1.000   1.188      5.312      0.375  -0.312   0.500   0.000
   0.000   0.000   0.000   0.000    -10.000     -1.000   1.000  -1.000   1.000
Ill conditioned matrix, A[3][3] = 0.000000e+00
</pre>
</code>
			</figure>

			
			<!-- <h2>C</h2>
			<figure>
				<code contenteditable="true">
<pre class="prettyprint linenums lang-c++ " contenteditable="true">

</pre>
</code>
			</figure> -->
		</div>

		<div id="footer">

			<div class="copy">&#169; 2020 Yutoのホームページ</div>
		</div>
	</div>
</div>
</body>

</html>
